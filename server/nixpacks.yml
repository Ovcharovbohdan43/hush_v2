# Railway Nixpacks configuration
# Install Rust nightly before building

phases:
  setup:
    nixPkgs:
      - rustc
      - cargo
    providers:
      - rust
  
  install:
    cmds:
      - export PATH="$HOME/.cargo/bin:$PATH"
      - if ! command -v rustup &> /dev/null; then curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh -s -- -y --default-toolchain nightly; fi
      - export PATH="$HOME/.cargo/bin:$PATH"
      - rustup default nightly
      - rustup update nightly
      - rustc --version
      - cargo --version
      - cargo build --release

start: ./target/release/hush-v2-server

